<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact - CasierPolitique.com</title>
    <meta name="description" content="Contactez-nous pour toute question ou suggestion concernant CasierPolitique.com">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.casierpolitique.com/contact">
    
    <!-- CSS Ã  ajouter -->
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="site-title">
                <a href="/">Casier Politique</a>
            </div>
        </div>
        <nav>
            <div class="nav-container">
                <a href="/" >Accueil</a>
                <a href="/profil/" >Profils</a>
                <a href="/sujet/" >Sujets</a>
            </div>
        </nav>
    </header>

    <main>
        
<div class="profil">
    <h1>Contact</h1>
    <div class="content">
        <h2>Nous contacter</h2>
        <p>Vous avez une question, une suggestion ou vous souhaitez nous faire part d'une information ? 
        N'hÃ©sitez pas Ã  nous contacter en utilisant le formulaire ci-dessous.</p>
        
        <form class="contact-form" id="contactForm">
            <div class="form-group">
                <label for="page">Page concernÃ©e :</label>
                <input type="text" id="page" name="page" placeholder="Ex: /profil/emmanuel-macron ou /sujet/jeux-olympiques-paris">
            </div>
            
            <div class="form-group">
                <label for="message">Votre message :</label>
                <textarea id="message" name="message" rows="6" placeholder="DÃ©crivez votre question, suggestion ou information..." required></textarea>
            </div>
            
            <!-- Altcha Captcha -->
            <div class="form-group">
                <altcha-widget 
                    id="captcha"
                    challenge-url="https://regal-nasturtium-30b87d.netlify.app/.netlify/functions/altcha"
                    theme="light"
                    lang="fr">
                </altcha-widget>
            </div>
            
            <button type="submit" class="btn-submit" id="submitBtn">Envoyer le message</button>
            
            <div id="formMessage" class="form-message" style="display: none;"></div>
        </form>
        
        <h2>Que pouvez-vous nous dire ?</h2>
        <ul>
            <li>Nouvelles personnalitÃ©s politiques Ã  ajouter</li>
            <li>Sujets d'actualitÃ© Ã  couvrir</li>
            <li>AmÃ©liorations de l'interface</li>
            <li>Nouvelles fonctionnalitÃ©s</li>
            <li>Corrections d'erreurs</li>
            <li>Informations Ã  ajouter sur une page existante</li>
        </ul>
        
        <h2>Merci</h2>
        <p>Merci de votre intÃ©rÃªt pour CasierPolitique.com et de votre contribution 
        Ã  l'amÃ©lioration de ce projet !</p>
    </div>
</div>

<!-- Altcha Captcha - ChargÃ© uniquement sur cette page -->
<script type="module" src="https://cdn.jsdelivr.net/npm/@altcha/altcha@1.0.0/dist/altcha.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    const formMessage = document.getElementById('formMessage');
    
    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        console.log('ğŸš€ DÃ©but de soumission du formulaire');
        
        // RÃ©cupÃ©rer les donnÃ©es du formulaire
        const page = document.getElementById('page').value;
        const message = document.getElementById('message').value;
        
        console.log('ğŸ“ DonnÃ©es du formulaire:', { page, message });
        
        // Validation du message
        if (!message.trim()) {
            console.log('âŒ Validation Ã©chouÃ©e: message vide');
            showMessage('Le message est requis', 'error');
            return;
        }
        
        // Validation du captcha
        const captcha = document.getElementById('captcha');
        if (!captcha || !captcha.hasAttribute('token')) {
            console.log('âŒ Validation Ã©chouÃ©e: captcha non rÃ©solu');
            showMessage('Veuillez complÃ©ter le captcha', 'error');
            return;
        }
        
        const captchaToken = captcha.getAttribute('token');
        console.log('âœ… Captcha validÃ©');
        
        console.log('âœ… Validation rÃ©ussie');
        
        // DÃ©sactiver le bouton et montrer le loading
        submitBtn.disabled = true;
        submitBtn.textContent = 'Envoi en cours...';
        hideMessage();
        
        const requestData = {
            page: page,
            message: message,
            captchaToken: captchaToken
        };
        
        console.log('ğŸ“¤ DonnÃ©es Ã  envoyer:', requestData);
        console.log('ğŸŒ URL de destination: https://regal-nasturtium-30b87d.netlify.app/.netlify/functions/contact');
        
        try {
            console.log('ğŸ”„ Envoi de la requÃªte...');
            
            // Envoyer vers l'API Netlify
            const response = await fetch('https://regal-nasturtium-30b87d.netlify.app/.netlify/functions/contact', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestData)
            });
            
            console.log('ğŸ“¥ RÃ©ponse reÃ§ue:', {
                status: response.status,
                statusText: response.statusText,
                ok: response.ok,
                headers: Object.fromEntries(response.headers.entries())
            });
            
            const data = await response.json();
            console.log('ğŸ“„ DonnÃ©es de rÃ©ponse:', data);
            
            if (response.ok && data.success) {
                console.log('âœ… SuccÃ¨s!');
                showMessage('Votre message a Ã©tÃ© envoyÃ© avec succÃ¨s !', 'success');
                form.reset();
            } else {
                console.log('âŒ Erreur dans la rÃ©ponse:', data.error);
                showMessage(data.error || 'Une erreur est survenue', 'error');
            }
            
        } catch (error) {
            console.error('ğŸ’¥ Erreur de connexion:', error);
            console.error('ğŸ’¥ Type d\'erreur:', error.name);
            console.error('ğŸ’¥ Message d\'erreur:', error.message);
            console.error('ğŸ’¥ Stack trace:', error.stack);
            showMessage('Erreur de connexion. Veuillez rÃ©essayer.', 'error');
        } finally {
            console.log('ğŸ Fin de traitement');
            // RÃ©activer le bouton
            submitBtn.disabled = false;
            submitBtn.textContent = 'Envoyer le message';
        }
    });
    
    function showMessage(text, type) {
        formMessage.textContent = text;
        formMessage.className = `form-message ${type}`;
        formMessage.style.display = 'block';
        
        // Scroll vers le message
        formMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    
    function hideMessage() {
        formMessage.style.display = 'none';
    }
});
</script>

    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="/mentions-legales">Mentions lÃ©gales</a>
                <a href="/contact">Contact</a>
            </div>
            <div class="footer-copyright">
                &copy; 2025 CasierPolitique.com
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/static/js/redirect.js"></script>
    <script src="/static/js/search-suggestions.js"></script>
    
</body>
</html> 