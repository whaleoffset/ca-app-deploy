<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact - CasierPolitique.com</title>
    <meta name="description" content="Contactez-nous pour toute question ou suggestion concernant CasierPolitique.com">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.casierpolitique.com/contact">
    
    <!-- CSS √† ajouter -->
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="site-title">
                <a href="/">Casier Politique</a>
            </div>
        </div>
        <nav>
            <div class="nav-container">
                <a href="/" >Accueil</a>
                <a href="/profil/" >Profils</a>
                <a href="/sujet/" >Sujets</a>
            </div>
        </nav>
    </header>

    <main>
        
<div class="profil">
    <h1>Contact</h1>
    <div class="content">
        <h2>Nous contacter</h2>
        <p>Vous avez une question, une suggestion ou vous souhaitez nous faire part d'une information ? 
        N'h√©sitez pas √† nous contacter en utilisant le formulaire ci-dessous.</p>
        
        <form class="contact-form" id="contactForm">
            <!-- Champ cach√© pour d√©tecter les bots -->
            <div class="form-group" style="display: none !important; position: absolute !important; left: -9999px !important;">
                <label for="website">Site web :</label>
                <input type="text" id="website" name="website" autocomplete="off" tabindex="-1">
            </div>
            
            <div class="form-group">
                <label for="page">Page concern√©e :</label>
                <input type="text" id="page" name="page" placeholder="Ex: /profil/emmanuel-macron ou /sujet/jeux-olympiques-paris">
            </div>
            
            <div class="form-group">
                <label for="message">Votre message :</label>
                <textarea id="message" name="message" rows="6" placeholder="D√©crivez votre question, suggestion ou information..." required></textarea>
            </div>
            
            <!-- Altcha Captcha -->
            <div class="form-group">
                <altcha-widget 
                    id="captcha"
                    challenge-url="https://regal-nasturtium-30b87d.netlify.app/.netlify/functions/altcha"
                    theme="light"
                    lang="fr">
                </altcha-widget>
            </div>
            
            <button type="submit" class="btn-submit" id="submitBtn">Envoyer le message</button>
            
            <div id="formMessage" class="form-message" style="display: none;"></div>
        </form>
        
        <h2>Que pouvez-vous nous dire ?</h2>
        <ul>
            <li>Nouvelles personnalit√©s politiques √† ajouter</li>
            <li>Sujets d'actualit√© √† couvrir</li>
            <li>Am√©liorations de l'interface</li>
            <li>Nouvelles fonctionnalit√©s</li>
            <li>Corrections d'erreurs</li>
            <li>Informations √† ajouter sur une page existante</li>
        </ul>
        
        <h2>Merci</h2>
        <p>Merci de votre int√©r√™t pour CasierPolitique.com et de votre contribution 
        √† l'am√©lioration de ce projet !</p>
    </div>
</div>

<!-- Altcha Captcha - Charg√© uniquement sur cette page -->
<script type="module" src="https://cdn.jsdelivr.net/npm/altcha@2.0.0/dist/altcha.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    const formMessage = document.getElementById('formMessage');
    
    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        console.log('üöÄ D√©but de soumission du formulaire');
        
        // R√©cup√©rer les donn√©es du formulaire
        const page = document.getElementById('page').value;
        const message = document.getElementById('message').value;
        const website = document.getElementById('website').value;
        
        console.log('üìù Donn√©es du formulaire:', { page, message, websiteFilled: !!website });
        
        // Validation du champ cach√© (d√©tection de bot)
        if (website.trim()) {
            console.log('üö´ Bot d√©tect√©');
            showMessage('Erreur de validation', 'error');
            return;
        }
        
        // Validation du message
        if (!message.trim()) {
            console.log('‚ùå Validation √©chou√©e: message vide');
            showMessage('Le message est requis', 'error');
            return;
        }
        
        // Validation du captcha
        const captcha = document.getElementById('captcha');
        if (!captcha || !captcha.hasAttribute('token')) {
            console.log('‚ùå Validation √©chou√©e: captcha non r√©solu');
            showMessage('Veuillez compl√©ter le captcha', 'error');
            return;
        }
        
        const captchaToken = captcha.getAttribute('token');
        console.log('‚úÖ Captcha valid√©');
        
        console.log('‚úÖ Validation r√©ussie');
        
        // D√©sactiver le bouton et montrer le loading
        submitBtn.disabled = true;
        submitBtn.textContent = 'Envoi en cours...';
        hideMessage();
        
        const requestData = {
            page: page,
            message: message,
            captchaToken: captchaToken,
            website: website
        };
        
        console.log('üì§ Donn√©es √† envoyer:', requestData);
        console.log('üåê URL de destination: https://regal-nasturtium-30b87d.netlify.app/.netlify/functions/contact');
        
        try {
            console.log('üîÑ Envoi de la requ√™te...');
            
            // Envoyer vers l'API Netlify
            const response = await fetch('https://regal-nasturtium-30b87d.netlify.app/.netlify/functions/contact', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestData)
            });
            
            console.log('üì• R√©ponse re√ßue:', {
                status: response.status,
                statusText: response.statusText,
                ok: response.ok,
                headers: Object.fromEntries(response.headers.entries())
            });
            
            const data = await response.json();
            console.log('üìÑ Donn√©es de r√©ponse:', data);
            
            if (response.ok && data.success) {
                console.log('‚úÖ Succ√®s!');
                showMessage('Votre message a √©t√© envoy√© avec succ√®s !', 'success');
                form.reset();
            } else {
                console.log('‚ùå Erreur dans la r√©ponse:', data.error);
                showMessage(data.error || 'Une erreur est survenue', 'error');
            }
            
        } catch (error) {
            console.error('üí• Erreur de connexion:', error);
            console.error('üí• Type d\'erreur:', error.name);
            console.error('üí• Message d\'erreur:', error.message);
            console.error('üí• Stack trace:', error.stack);
            showMessage('Erreur de connexion. Veuillez r√©essayer.', 'error');
        } finally {
            console.log('üèÅ Fin de traitement');
            // R√©activer le bouton
            submitBtn.disabled = false;
            submitBtn.textContent = 'Envoyer le message';
        }
    });
    
    function showMessage(text, type) {
        formMessage.textContent = text;
        formMessage.className = `form-message ${type}`;
        formMessage.style.display = 'block';
        
        // Scroll vers le message
        formMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    
    function hideMessage() {
        formMessage.style.display = 'none';
    }
});
</script>

    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="/mentions-legales">Mentions l√©gales</a>
                <a href="/contact">Contact</a>
            </div>
            <div class="footer-copyright">
                &copy; 2025 CasierPolitique.com
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/static/js/redirect.js"></script>
    <script src="/static/js/search-suggestions.js"></script>
    
</body>
</html> 